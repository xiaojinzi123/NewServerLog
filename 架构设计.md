## 前言

**ServerLog** 是一套消息转发的架构.**ServerLog** 分为两部分

- 服务端 **Server**
- 客户端 **Client** 
  - 每一个 Client 可以有不同的角色.

两者通过长连接连接. **Server** <==> **Client**

 **ServerLog** 提供了一个通用的数据传送的数据结构. **Message** (结构见下文)

## Server

- 维护与 **Client** 的连接状态. 一旦心跳发送失败, 就踢掉了
- 对数据进行转发. 将 Message 发送给需要此数据的 **Client** 
- 不直接产生 **Message** 数据, 但是可以拥有对**数据拦截、转发、加工**等操作. 同时也可以 **发送消息给任何一个 Client**
- 心跳功能, 每隔一段时间会发送一个心跳包, 用于确认连接状态
- 为每一个 **Client** 生成一个唯一的 Tag
- 当 **Client** 的连接发生变化的时候, 主动会将对应的 **Client** 信息发送给订阅

## Client

每一个 **Client** 可以有不同的角色. 可以是消息 **Producer**, 也可以是消息 **Customer**

甚至同时可以是消息  **Producer** 和  **Customer**

每一个 **Client** 的主要功能如下：

- 保持与 **Server** 稳定的连接
- 最好能支持发送**心跳包**
- 拥有接受 **text** 类型的信息和发送 **text** 数据的能力

##  Message 数据结构

- type 标记数据的类型. 可以自定义
- data 具体的数据. 这个数据的格式和 type 息息相关
- selfTag 表示消息的发送者
  - **Server** 有一个唯一并且固定的 **tag**, 值是 "Server"
- targetTag 表示消息的接受者

### 内置的一些消息类型(action的值)

- heartbeat 表示心跳包类型. 
  - data 为 null
- setSubscribeTypes 表示一个 Client 订阅的数据类型是哪些
  - data 是一个 String 数组
- setProviderTypes  表示一个 Client 提供的数据的类型是哪些
  - Data 是一个 String 数组









